var SWEEPER={gameArea:void 0,buttons:{start:void 0,reset:void 0},inputs:{rows:void 0,cols:void 0,mines:void 0},MAX_ROWS:50,MAX_COLS:50,MIN_ROWS:8,MIN_COLS:8,NUM_ROWS:void 0,NUM_COLS:void 0,MINES:[],MAX_MINES:void 0,MIN_MINES:8,NUM_MINES:void 0};SWEEPER.getGameArea=function(){return this.gameArea},SWEEPER.init=function(t){"object"==typeof t&&this.setOptions(t);try{this._checkElements()}catch(t){swal({title:"Failed to start elements!",text:t.message,icon:"error",button:{visible:!1},closeOnClickOutside:!1,closeOnEsc:!1})}},SWEEPER.setOptions=function(t){for(var i in t)t.hasOwnProperty(i)&&this.hasOwnProperty(i)&&(this[i]=t[i])},SWEEPER.startGame=function(){try{this._checkConfig(),void 0===this.game&&(SWEEPER.gameArea.html(""),this.game=new SWEEPER.Game(this.NUM_ROWS,this.NUM_COLS,this.NUM_MINES),this.game.init()),this.buttons.start.attr("disabled",!0)}catch(t){swal({title:"Failed to start the game!",text:t.message,icon:"error"})}},SWEEPER.resetGame=function(){void 0!==this.game&&this.game.reset()},SWEEPER._checkConfig=function(){if("number"!=typeof this.NUM_ROWS)throw Error("Number of rows is not a valid number!");if("number"!=typeof this.NUM_COLS)throw Error("Number of columns is not a valid number!");if("number"!=typeof this.NUM_MINES)throw Error("Number of mines is not a valid number!")},SWEEPER._checkElements=function(){if(void 0===this.gameArea)throw Error("Game area has not been defined!");if(void 0===this.buttons.start)throw Error("No start button has been set!");if(void 0===this.buttons.reset)throw Error("No reset button has been set!");if(void 0===this.inputs.rows)throw Error("No input element for number of rows!");if(void 0===this.inputs.cols)throw Error("No input element for number of columns!");if(void 0===this.inputs.mines)throw Error("No input element for number of mines!");this._configElements()},SWEEPER._configElements=function(){var t=this;this.buttons.start.on("click",function(i){t._handleStartButtonClick($(this),i)}),this.buttons.reset.on("click",function(i){t._handleResetButtonClick($(this),i)}),this.inputs.values={},this.inputs.values.rows=$("#num-rows-value"),this.inputs.values.cols=$("#num-cols-value"),this.inputs.values.mines=$("#num-mines-value"),this.inputs.rows.on("input",function(i){t._handleRowsInputChange($(this),i)}),this.inputs.rows.trigger("input"),this.inputs.cols.on("input",function(i){t._handleColsInputChange($(this),i)}),this.inputs.cols.trigger("input"),this.inputs.mines.on("input",function(i){t._handleMinesInputChange($(this),i)}),this.inputs.mines.trigger("input"),document.oncontextmenu=function(t){return t.cancelBubble=!0,t.returnValue=!1,!1},document.onmousedown=function(t){if(2===t.button||3===t.button)return t.cancelBubble=!0,t.returnValue=!1,!1}},SWEEPER._handleStartButtonClick=function(t,i){this.startGame()},SWEEPER._handleResetButtonClick=function(t,i){this.resetGame()},SWEEPER._handleRowsInputChange=function(t,i){var s=parseInt(t.val(),10);s<this.MIN_ROWS?s=this.MIN_ROWS:s>this.MAX_ROWS&&(s=this.MAX_ROWS),this.NUM_ROWS=s,this.inputs.rows.val(this.NUM_ROWS),this.inputs.values.rows.text(this.NUM_ROWS),this._handleNumOfMines()},SWEEPER._handleColsInputChange=function(t,i){var s=parseInt(t.val(),10);s<this.MIN_COLS?s=this.MIN_COLS:s>this.MAX_COLS&&(s=this.MAX_COLS),this.NUM_COLS=s,this.inputs.cols.val(this.NUM_COLS),this.inputs.values.cols.text(this.NUM_COLS),this._handleNumOfMines()},SWEEPER._handleNumOfMines=function(){this.MAX_MINES=Math.floor(this.NUM_ROWS*this.NUM_COLS/2),this.NUM_MINES>this.MAX_MINES&&(this.NUM_MINES=this.MAX_MINES),this.inputs.mines.attr("max",this.MAX_MINES),this.inputs.mines.trigger("input")},SWEEPER._handleMinesInputChange=function(t,i){var s=parseInt(t.val(),10);s<this.MIN_MINES?s=this.MIN_MINES:s>this.MAX_MINES&&(s=this.MAX_MINES),this.NUM_MINES=s,this.inputs.mines.val(this.NUM_MINES),this.inputs.values.mines.text(this.NUM_MINES+" (Max: "+this.MAX_MINES+")")};
SWEEPER.Game=function(e,t,i){this.numRows=e,this.numCols=t,this.numMines=i,this.restMines=i,this.isGameStarted=!1,this.isGameFinished=!1,this.isFirstClick=!1,this.timeCount=0,this.timerId=void 0,this.mainContainer=void 0,this.functionBar=void 0,this.functionPanel=void 0,this.leftBox=void 0,this.rightBox=void 0,this.middleBox=void 0,this.faceButton=void 0,this.mineArea=void 0,this.mineTable=void 0},SWEEPER.Game.prototype.constructor=SWEEPER.Game,SWEEPER.Game.prototype.getNumRows=function(){return this.numRows},SWEEPER.Game.prototype.getNumCols=function(){return this.numCols},SWEEPER.Game.prototype.getNumMines=function(){return this.numMines},SWEEPER.Game.BLOCK_TYPE_DEFAULT=0,SWEEPER.Game.BLOCK_TYPE_MINE=9,SWEEPER.Game.MOUSE_BUTTON_LEFT=0,SWEEPER.Game.MOUSE_BUTTON_MIDDLE=1,SWEEPER.Game.MOUSE_BUTTON_RIGHT=2,SWEEPER.Game.GAME_OVER_WIN=0,SWEEPER.Game.GAME_OVER_LOST=1,SWEEPER.Game.GAME_OVER_TIMEOUT=2,SWEEPER.Game.prototype.init=function(){if("number"!=typeof this.getNumRows())throw Error("The number of rows is not a number!");if("number"!=typeof this.getNumCols())throw Error("The number of columns is not a number!");if("number"!=typeof this.getNumMines())throw Error("The number of mines is not a number!");this._createMainContainer()},SWEEPER.Game.prototype._createMainContainer=function(){var e=24*this.getNumCols()+14;this.mainContainer=document.createElement("div"),this.mainContainer.className="main_container",this.mainContainer.style.width=e+"px",this._createFunctionBar(),this._createMineArea(),SWEEPER.getGameArea().append(this.mainContainer)},SWEEPER.Game.prototype.reset=function(){this._refreshMainContainer()},SWEEPER.Game.prototype._refreshMainContainer=function(){this.isGameStarted=!1,this.isGameFinished=!1,this.isFirstClick=!1,clearInterval(this.timerId),this.timeCount=0,this.restMines=this.getNumMines(),SWEEPER.getGameArea().html(""),this._createMainContainer()},SWEEPER.Game.prototype._createFunctionBar=function(){this.functionBar=document.createElement("div"),this.functionBar.className="function_bar_div",this.functionPanel=document.createElement("div"),this.functionPanel.className="panel_down_div",this.leftBox=document.createElement("div"),this.leftBox.className="function_left_div",this.leftBox.innerText=""+this.getNumMines(),this.functionPanel.appendChild(this.leftBox),this.rightBox=document.createElement("div"),this.rightBox.className="function_right_div",this.rightBox.innerText="0",this.functionPanel.appendChild(this.rightBox),this.middleBox=document.createElement("div"),this.middleBox.className="function_mid_div",this._createFaceButton(),this.functionPanel.appendChild(this.middleBox),this.functionBar.appendChild(this.functionPanel),this.mainContainer.appendChild(this.functionBar)},SWEEPER.Game.prototype._createFaceButton=function(){var e=document.createElement("div");e.className="container_border",e.style.width="30px",this.faceButton=document.createElement("div"),this.faceButton.className="img_button_up",this.faceButton.style.width="25px",this.faceButton.style.height="25px",this.faceButton.innerHTML='<i class="fa fa-smile-o"></i>',this.faceButton.setAttribute("pushed",!1);var t=this;this.faceButton.onmousedown=function(){this.className="img_button_down",this.setAttribute("pushed",!0)},this.faceButton.onmouseout=function(){"true"===this.getAttribute("pushed")&&(this.className="img_button_up",this.setAttribute("pushed",!1))},this.faceButton.onmouseup=function(){if("false"===this.getAttribute("pushed"))return!1;this.className="img_button_up",this.setAttribute("pushed",!1),t._refreshMainContainer()},e.appendChild(this.faceButton),this.middleBox.appendChild(e)},SWEEPER.Game.prototype._createMineArea=function(){var e,t,i,n,s,a;this.mineArea=document.createElement("div"),this.mineArea.className="panel_down_nopadding_div",this.mineTable=document.createElement("table"),this.mineTable.className="mine_area_table";var r=document.createElement("tbody"),m=this._initMineArea(this.getNumRows(),this.getNumCols(),this.getNumMines());for(e=0;e<this.getNumRows();e++){for(n=document.createElement("tr"),t=0;t<this.getNumCols();t++)s=document.createElement("td"),i=e*this.getNumCols()+t,a=this._createMineButton(m[i],i),s.appendChild(a),n.appendChild(s);r.appendChild(n)}this.mineTable.appendChild(r),this.mineArea.appendChild(this.mineTable),this.mainContainer.appendChild(this.mineArea)},SWEEPER.Game.prototype._createMineButton=function(e,t){var i,n,s,a,r=document.createElement("div");r.id="mine_"+t,r.className="mine_up",r.style.width="18px",r.style.height="18px",r.setAttribute("mine_value",e),r.setAttribute("mine_index",t),r.setAttribute("marked",!1),r.setAttribute("opened",!1),r.setAttribute("expanded",!1),r.setAttribute("pushed",!1),r.setAttribute("detected",!1);var m=this;return r.onmousedown=function(e){if(m.isGameFinished)return!1;if(e.button===SWEEPER.Game.MOUSE_BUTTON_LEFT){if("true"===this.getAttribute("marked")||"true"===this.getAttribute("expanded"))return!1;this.setAttribute("pushed",!0),this.className="mine_down"}if(e.button===SWEEPER.Game.MOUSE_BUTTON_RIGHT&&(m._beginTimer(),"false"===(n=this.getAttribute("expanded"))))if(a=this.getAttribute("detected"),s=this.getAttribute("marked"),this.className="mine_up","false"===s){if("true"===a)return this.setAttribute("detected",!1),this.innerText="",!1;this.innerHTML='<i class="fa fa-flag"></i>',this.setAttribute("marked",!0),m.restMines--,m.leftBox.innerText=m.restMines.toString(),m.checkGameStatus()}else m.restMines++,m.leftBox.innerText=m.restMines.toString(),this.removeChild(this.firstChild),this.setAttribute("marked",!1),"false"===a?(this.setAttribute("detected",!0),this.innerText="?",this.className="mine_up"):this.setAttribute("detected",!1);if(e.button===SWEEPER.Game.MOUSE_BUTTON_MIDDLE){"false"===this.getAttribute("expanded")&&"false"===this.getAttribute("marked")&&(this.className="mine_down"),this.setAttribute("pushed",!1),this.setAttribute("detecting",!0);for(var t,i,u,o,d=m.getNumCols(),h=m.getNumRows(),E=parseInt(r.getAttribute("mine_index"),10),l=E%d,c=Math.round((E-l)/d),_=-1;_<=1;_++)if(!((t=c+_)<0||t>h-1))for(var f=-1;f<=1;f++)(i=l+f)>d-1||i<0||(u=t*d+i,null!==(o=document.getElementById("mine_"+u))&&"false"===o.getAttribute("marked")&&"false"===o.getAttribute("expanded")&&"false"===o.getAttribute("detected")&&(o.className="mine_down"))}},r.onmouseout=function(e){if(m.isGameFinished)return!1;if("true"===this.getAttribute("pushed")&&(this.className="mine_up",this.setAttribute("pushed","false")),"true"===this.getAttribute("detecting")){"false"===this.getAttribute("expanded")&&"false"===this.getAttribute("marked")&&(this.className="mine_up"),this.setAttribute("detecting",!1);for(var t,i,n,s,a=m.getNumCols(),r=m.getNumRows(),u=parseInt(this.getAttribute("mine_index"),10),o=u%a,d=Math.round((u-o)/a),h=-1;h<=1;h++)if(!((t=d+h)<0||t>r-1))for(j=-1;j<=1;j++)(i=o+j)>a-1||i<0||(n=t*a+i,null!==(s=document.getElementById("mine_"+n))&&"false"===s.getAttribute("marked")&&"false"===s.getAttribute("expanded")&&(s.className="mine_up"))}},r.onmouseup=function(e){if(m.isGameFinished)return!1;if("true"===this.getAttribute("detecting")){"false"===this.getAttribute("expanded")&&"false"===this.getAttribute("marked")&&(this.className="mine_up"),this.setAttribute("detecting",!1);var t,i,n,s,a,r,u=m.getNumCols(),o=m.getNumRows(),d=parseInt(this.getAttribute("mine_index"),10),h=d%u,E=Math.round((d-h)/u),l=0;if("true"===this.getAttribute("expanded")){for(a=-1;a<=1;a++)if(!((t=E+a)<0||t>o-1))for(r=-1;r<=1;r++)(i=h+r)>u-1||i<0||(n=t*u+i,null!==(s=document.getElementById("mine_"+n))&&"true"===s.getAttribute("marked")&&l++);if(l===parseInt(this.getAttribute("mine_value"),10)){for(a=-1;a<=1;a++)if(!((t=E+a)<0||t>o-1))for(r=-1;r<=1;r++)(i=h+r)>u-1||i<0||(n=t*u+i,null!==(s=document.getElementById("mine_"+n))&&"false"===s.getAttribute("marked")&&"false"===s.getAttribute("expanded")&&(s.setAttribute("pushed",!0),s.expandCover()));return!1}}for(a=-1;a<=1;a++)if(!((t=E+a)<0||t>o-1))for(r=-1;r<=1;r++)(i=h+r)>u-1||i<0||(n=t*u+i,null!==(s=document.getElementById("mine_"+n))&&"false"===s.getAttribute("marked")&&"false"===s.getAttribute("expanded")&&(s.className="mine_up"));return!1}e.button===SWEEPER.Game.MOUSE_BUTTON_LEFT&&this.expandCover()},r.expandCover=function(){if(m.isGameFinished)return!1;if("false"===this.getAttribute("pushed"))return!1;if(this.setAttribute("pushed",!1),!m.isFirstClick&&(m.isFirstClick=!0,(i=parseInt(this.getAttribute("mine_value"),10))===SWEEPER.Game.BLOCK_TYPE_MINE)){var e,t=parseInt(this.getAttribute("mine_index"),10),n=m.getNumCols(),s=m.getNumRows(),a=m.getNumMines(),r=m._initMineArea(s,n,a,t);for(e=0;e<s*n;e++)document.getElementById("mine_"+e).setAttribute("mine_value",r[e])}if(m._beginTimer(),"true"===this.getAttribute("marked")||"true"===this.getAttribute("expanded"))return!1;switch(this.setAttribute("detected",!1),i=parseInt(this.getAttribute("mine_value"),10)){case SWEEPER.Game.BLOCK_TYPE_DEFAULT:t=parseInt(this.getAttribute("mine_index"),10),this.innerText="",m._expandMineArea(t);break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:this.className="mine_down_"+i,this.setAttribute("expanded",!0),this.innerText=i.toString();break;case SWEEPER.Game.BLOCK_TYPE_MINE:this.className="mine_down_bomb_blast",this.setAttribute("expanded",!0),"false"===this.getAttribute("opened")&&(this.hasChildNodes()&&this.removeChild(this.firstChild),this.innerHTML='<i class="fa fa-bomb"></i>',m.gameOver(SWEEPER.Game.GAME_OVER_LOST)),this.setAttribute("opened",!0)}m.checkGameStatus()},r},SWEEPER.Game.prototype.checkGameStatus=function(){var e,t=!1,n=this.getNumCols(),s=this.getNumRows();for(i=0;i<s*n;i++)if(e=document.getElementById("mine_"+i),parseInt(e.getAttribute("mine_value"),10)===SWEEPER.Game.BLOCK_TYPE_MINE){if("false"===e.getAttribute("marked")){t=!1;break}t=!0}else{if("false"===e.getAttribute("expanded")){t=!1;break}t=!0}t&&this.gameOver(SWEEPER.Game.GAME_OVER_WIN)},SWEEPER.Game.prototype.gameOver=function(e){var t,i,n;switch(e){case SWEEPER.Game.GAME_OVER_WIN:this.faceButton.innerHTML='<i class="fa fa-star"></i>',t="Well done!",i="You cleared "+this.getNumMines()+" mines in only "+this.timeCount+" seconds",n="success";break;case SWEEPER.Game.GAME_OVER_LOST:this._expandAll(),this.faceButton.innerHTML='<i class="fa fa-bomb"></i>',t="You lost!",i="You failed to clear "+this.getNumMines()+" mines, please try again!",n="error";break;case SWEEPER.Game.GAME_OVER_TIMEOUT:this._expandAll(),this.faceButton.innerHTML='<i class="fa fa-bomb"></i>',t="You ran out of time!",i="Whoa! It really takes you that long? Try again!",n="error"}swal({title:t,text:i,icon:n}),clearInterval(this.timerId),this.isGameStarted=!1,this.isGameFinished=!0},SWEEPER.Game.prototype._beginTimer=function(){if(this.isGameStarted)return!1;var e=this;return this.timerId=window.setInterval(function(){e.timeCount++,e.timeCount>999?e.gameOver(SWEEPER.Game.GAME_OVER_TIMEOUT):e.rightBox.innerText=e.timeCount.toString()},1e3),this.isGameStarted=!0,!0},SWEEPER.Game.prototype._expandMineArea=function(e){e=parseInt(e,10);var t,i,n,s,a=this.getNumCols(),r=this.getNumRows();if(i=e%a,t=Math.round((e-i)/a),mine=document.getElementById("mine_"+e),"true"===mine.getAttribute("marked")||"true"===mine.getAttribute("expanded")||"true"===mine.getAttribute("detected"))return null;switch(s=parseInt(mine.getAttribute("mine_value"),10)){case SWEEPER.Game.BLOCK_TYPE_DEFAULT:if(mine.className="mine_down","true"===mine.getAttribute("expanded"))return null;mine.setAttribute("expanded",!0),i-1>=0&&(n=a*t+i-1,this._expandMineArea(n)),i+1<a&&(n=a*t+i+1,this._expandMineArea(n)),t-1>=0&&(n=a*(t-1)+i,this._expandMineArea(n),i-1>=0&&(n=a*(t-1)+i-1,this._expandMineArea(n)),i+1<a&&(n=a*(t-1)+i+1,this._expandMineArea(n))),t+1<r&&(n=a*(t+1)+i,this._expandMineArea(n),i-1>=0&&(n=a*(t+1)+i-1,this._expandMineArea(n)),i+1<a&&(n=a*(t+1)+i+1,this._expandMineArea(n)));break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:mine.className="mine_down_"+s,mine.innerText=s.toString(),mine.setAttribute("expanded",!0);break;case SWEEPER.Game.BLOCK_TYPE_MINE:}return null},SWEEPER.Game.prototype._expandAll=function(){var e,t,i,n=this.getNumCols()*this.getNumRows();for(e=0;e<n;e++)if(i=document.getElementById("mine_"+e),t=parseInt(i.getAttribute("mine_value"),10),"false"===i.getAttribute("expanded")){switch(t){case SWEEPER.Game.BLOCK_TYPE_MINE:if("true"===i.getAttribute("marked")){i.className="mine_down_bomb";break}i.hasChildNodes()&&i.removeChild(i.firstChild),i.className="mine_down_bomb",i.innerHTML='<i class="fa fa-bomb"></i>',i.setAttribute("expanded",!0)}"true"===i.getAttribute("marked")&&t!==SWEEPER.Game.BLOCK_TYPE_MINE&&(i.hasChildNodes()&&i.removeChild(i.firstChild),i.className="mine_down_bomb",i.innerText="",i.innerHTML='<i class="fa fa-times"></i>',i.setAttribute("expanded",!0))}},SWEEPER.Game.prototype._initMineArea=function(e,t,i,n){var s,a,r,m,u,o=e*t,d=new Array(o),h=new Array(o);for(s=0;s<o;s++)h[s]=s;for(s=0;s<2*o;s++){r=Math.round(Math.random()*o),m=Math.round(Math.random()*o);var E=h[r];h[r]=h[m],h[m]=E}for(s=0;s<e;s++)for(a=0;a<t;a++)d[u=t*s+a]=SWEEPER.Game.BLOCK_TYPE_DEFAULT;if(n)for(s=0;i;s++)if(h[s]===n){var l=h[s];h[s]=h[o],h[o]=l;break}for(s=0;s<i;s++)d[h[s]]=SWEEPER.Game.BLOCK_TYPE_MINE;for(s=0;s<e;s++)for(a=0;a<t;a++)d[u=t*s+a]===SWEEPER.Game.BLOCK_TYPE_MINE&&(a-1>=0&&d[u=t*s+a-1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,a+1<t&&d[u=t*s+a+1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,s-1>=0&&(d[u=t*(s-1)+a]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,a-1>=0&&d[u=t*(s-1)+a-1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,a+1<t&&d[u=t*(s-1)+a+1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++),s+1<e&&(d[u=t*(s+1)+a]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,a-1>=0&&d[u=t*(s+1)+a-1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++,a+1<t&&d[u=t*(s+1)+a+1]!==SWEEPER.Game.BLOCK_TYPE_MINE&&d[u]++));return d};
//# sourceMappingURL=sweeper.min.js.map
